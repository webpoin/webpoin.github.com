define(function(c,b,a){var d=c("jquery");(function(g){var f={tagClass:function(n){return"label label-info"},itemValue:function(n){return n?n.toString():n},itemText:function(n){return this.itemValue(n)},freeInput:true,addOnBlur:true,maxTags:undefined,maxChars:undefined,confirmKeys:[13,44],onTagExists:function(o,n){n.hide().fadeIn()},trimValue:false,allowDuplicates:false};function k(o,n){this.itemsArray=[];this.$element=g(o);this.$element.hide();this.isSelect=(o.tagName==="SELECT");this.multiple=(this.isSelect&&o.hasAttribute("multiple"));this.objectItems=n&&n.itemValue;this.placeholderText=o.hasAttribute("placeholder")?this.$element.attr("placeholder"):"";this.inputSize=Math.max(1,this.placeholderText.length);this.$container=g('<div class="bootstrap-tagsinput"></div>');this.$input=g('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container);this.$element.after(this.$container);var p=(this.inputSize<3?3:this.inputSize)+"em";this.$input.get(0).style.cssText="width: "+p+" !important;";this.build(n)}k.prototype={constructor:k,add:function(x,u){var y=this;if(y.options.maxTags&&y.itemsArray.length>=y.options.maxTags){return}if(x!==false&&!x){return}if(typeof x==="string"&&y.options.trimValue){x=g.trim(x)}if(typeof x==="object"&&!y.objectItems){throw ("Can't add objects when itemValue option is not set")}if(x.toString().match(/^\s*$/)){return}if(y.isSelect&&!y.multiple&&y.itemsArray.length>0){y.remove(y.itemsArray[0])}if(typeof x==="string"&&this.$element[0].tagName==="INPUT"){var v=x.split(",");if(v.length>1){for(var s=0;s<v.length;s++){this.add(v[s],true)}if(!u){y.pushVal()}return}}var p=y.options.itemValue(x),w=y.options.itemText(x),r=y.options.tagClass(x);var o=g.grep(y.itemsArray,function(A){return y.options.itemValue(A)===p})[0];if(o&&!y.options.allowDuplicates){if(y.options.onTagExists){var q=g(".tag",y.$container).filter(function(){return g(this).data("item")===o});y.options.onTagExists(x,q)}return}if(y.items().toString().length+x.length+1>y.options.maxInputLength){return}var z=g.Event("beforeItemAdd",{item:x,cancel:false});y.$element.trigger(z);if(z.cancel){return}y.itemsArray.push(x);var t=g('<span class="tag '+j(r)+'">'+j(w)+'<span data-role="remove"></span></span>');t.data("item",x);y.findInputWrapper().before(t);t.after(" ");if(y.isSelect&&!g('option[value="'+encodeURIComponent(p)+'"]',y.$element)[0]){var n=g("<option selected>"+j(w)+"</option>");n.data("item",x);n.attr("value",p);y.$element.append(n)}if(!u){y.pushVal()}if(y.options.maxTags===y.itemsArray.length||y.items().toString().length===y.options.maxInputLength){y.$container.addClass("bootstrap-tagsinput-max")}y.$element.trigger(g.Event("itemAdded",{item:x}))},remove:function(o,p){var n=this;if(n.objectItems){if(typeof o==="object"){o=g.grep(n.itemsArray,function(r){return n.options.itemValue(r)==n.options.itemValue(o)})}else{o=g.grep(n.itemsArray,function(r){return n.options.itemValue(r)==o})}o=o[o.length-1]}if(o){var q=g.Event("beforeItemRemove",{item:o,cancel:false});n.$element.trigger(q);if(q.cancel){return}g(".tag",n.$container).filter(function(){return g(this).data("item")===o}).remove();g("option",n.$element).filter(function(){return g(this).data("item")===o}).remove();if(g.inArray(o,n.itemsArray)!==-1){n.itemsArray.splice(g.inArray(o,n.itemsArray),1)}}if(!p){n.pushVal()}if(n.options.maxTags>n.itemsArray.length){n.$container.removeClass("bootstrap-tagsinput-max")}n.$element.trigger(g.Event("itemRemoved",{item:o}))},removeAll:function(){var n=this;g(".tag",n.$container).remove();g("option",n.$element).remove();while(n.itemsArray.length>0){n.itemsArray.pop()}n.pushVal()},refresh:function(){var n=this;g(".tag",n.$container).each(function(){var p=g(this),r=p.data("item"),s=n.options.itemValue(r),o=n.options.itemText(r),t=n.options.tagClass(r);p.attr("class",null);p.addClass("tag "+j(t));p.contents().filter(function(){return this.nodeType==3})[0].nodeValue=j(o);if(n.isSelect){var q=g("option",n.$element).filter(function(){return g(this).data("item")===r});q.attr("value",s)}})},items:function(){return this.itemsArray},pushVal:function(){var n=this,o=g.map(n.items(),function(p){return n.options.itemValue(p).toString()});n.$element.val(o,true).trigger("change")},build:function(o){var n=this;n.options=g.extend({},f,o);if(n.objectItems){n.options.freeInput=false}e(n.options,"itemValue");e(n.options,"itemText");l(n.options,"tagClass");if(n.options.typeahead){var q=n.options.typeahead||{};l(q,"source");n.$input.typeahead(g.extend({},q,{source:function(t,v){function r(w){var y=[];for(var x=0;x<w.length;x++){var z=n.options.itemText(w[x]);u[z]=w[x];y.push(z)}v(y)}this.map={};var u=this.map,s=q.source(t);if(g.isFunction(s.success)){s.success(r)}else{if(g.isFunction(s.then)){s.then(r)}else{g.when(s).then(r)}}},updater:function(r){n.add(this.map[r])},matcher:function(r){return(r.toLowerCase().indexOf(this.query.trim().toLowerCase())!==-1)},sorter:function(r){return r.sort()},highlighter:function(s){var r=new RegExp("("+this.query+")","gi");return s.replace(r,"<strong>$1</strong>")}}))}if(n.options.typeaheadjs){var p=n.options.typeaheadjs||{};n.$input.typeahead(null,p).on("typeahead:selected",g.proxy(function(s,r){if(p.valueKey){n.add(r[p.valueKey])}else{n.add(r)}n.$input.typeahead("val","")},n))}n.$container.on("click",g.proxy(function(r){if(!n.$element.attr("disabled")){n.$input.removeAttr("disabled")}n.$input.focus()},n));if(n.options.addOnBlur&&n.options.freeInput){n.$input.on("focusout",g.proxy(function(r){if(g(".typeahead, .twitter-typeahead",n.$container).length===0){n.add(n.$input.val());n.$input.val("")}},n))}n.$container.on("keydown","input",g.proxy(function(r){var v=g(r.target),w=n.findInputWrapper();if(n.$element.attr("disabled")){n.$input.attr("disabled","disabled");return}switch(r.which){case 8:if(i(v[0])===0){var s=w.prev();if(s){n.remove(s.data("item"))}}break;case 46:if(i(v[0])===0){var t=w.next();if(t){n.remove(t.data("item"))}}break;case 37:var x=w.prev();if(v.val().length===0&&x[0]){x.before(w);v.focus()}break;case 39:var u=w.next();if(v.val().length===0&&u[0]){u.after(w);v.focus()}break;default:}var A=v.val().length,y=Math.ceil(A/5),z=A+y+1;v.attr("size",Math.max(this.inputSize,v.val().length))},n));n.$container.on("keypress","input",g.proxy(function(v){var x=g(v.target);if(n.$element.attr("disabled")){n.$input.attr("disabled","disabled");return}var w=x.val(),u=n.options.maxChars&&w.length>=n.options.maxChars;if(n.options.freeInput&&(h(v,n.options.confirmKeys)||u)){n.add(u?w.substr(0,n.options.maxChars):w);x.val("");v.preventDefault()}var t=x.val().length,s=Math.ceil(t/5),r=t+s+1;x.attr("size",Math.max(this.inputSize,x.val().length))},n));n.$container.on("click","[data-role=remove]",g.proxy(function(r){if(n.$element.attr("disabled")){return}n.remove(g(r.target).closest(".tag").data("item"))},n));if(n.options.itemValue===f.itemValue){if(n.$element[0].tagName==="INPUT"){n.add(n.$element.val())}else{g("option",n.$element).each(function(){n.add(g(this).attr("value"),true)})}}},destroy:function(){var n=this;n.$container.off("keypress","input");n.$container.off("click","[role=remove]");n.$container.remove();n.$element.removeData("tagsinput");n.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){var o=this.$input[0],n=this.$container[0];while(o&&o.parentNode!==n){o=o.parentNode}return g(o)}};g.fn.tagsinput=function(o,n){var p=[];this.each(function(){var r=g(this).data("tagsinput");if(!r){r=new k(this,o);g(this).data("tagsinput",r);p.push(r);if(this.tagName==="SELECT"){g("option",g(this)).attr("selected","selected")}g(this).val(g(this).val())}else{if(!o&&!n){p.push(r)}else{if(r[o]!==undefined){var q=r[o](n);if(q!==undefined){p.push(q)}}}}});if(typeof o=="string"){return p.length>1?p:p[0]}else{return p}};g.fn.tagsinput.Constructor=k;function e(o,p){if(typeof o[p]!=="function"){var n=o[p];o[p]=function(q){return q[n]}}}function l(n,o){if(typeof n[o]!=="function"){var p=n[o];n[o]=function(){return p}}}var m=g("<div />");function j(n){if(n){return m.text(n).html()}else{return""}}function i(o){var p=0;if(document.selection){o.focus();var n=document.selection.createRange();n.moveStart("character",-o.value.length);p=n.text.length}else{if(o.selectionStart||o.selectionStart=="0"){p=o.selectionStart}}return(p)}function h(n,p){var o=false;g.each(p,function(s,r){if(typeof(r)==="number"&&n.which===r){o=true;return false}if(n.which===r.which){var u=!r.hasOwnProperty("altKey")||n.altKey===r.altKey,q=!r.hasOwnProperty("shiftKey")||n.shiftKey===r.shiftKey,t=!r.hasOwnProperty("ctrlKey")||n.ctrlKey===r.ctrlKey;if(u&&q&&t){o=true;return false}}});return o}g(function(){g("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})})(window.jQuery)});
;

;
