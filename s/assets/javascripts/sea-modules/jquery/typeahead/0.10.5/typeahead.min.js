/*!
 * typeahead.js 0.10.5
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2014 Twitter, Inc. and other contributors; Licensed MIT
 */
define(function(c,b,a){var d=c("jquery");(function(f){var u=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:false},isBlankString:function(y){return !y||/^\s*$/.test(y)},escapeRegExChars:function(y){return y.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(y){return typeof y==="string"},isNumber:function(y){return typeof y==="number"},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isPlainObject,isUndefined:function(y){return typeof y==="undefined"},toStr:function x(y){return u.isUndefined(y)||y===null?"":y+""},bind:f.proxy,each:function(A,y){f.each(A,z);function z(B,C){return y(C,B)}},map:f.map,filter:f.grep,every:function(z,A){var y=true;if(!z){return y}f.each(z,function(B,C){if(!(y=A.call(null,C,B,z))){return false}});return !!y},some:function(z,A){var y=false;if(!z){return y}f.each(z,function(B,C){if(y=A.call(null,C,B,z)){return false}});return !!y},mixin:f.extend,getUniqueId:function(){var y=0;return function(){return y++}}(),templatify:function w(z){return f.isFunction(z)?z:y;function y(){return String(z)}},defer:function(y){setTimeout(y,0)},debounce:function(A,C,z){var B,y;return function(){var G=this,F=arguments,E,D;E=function(){B=null;if(!z){y=A.apply(G,F)}};D=z&&!B;clearTimeout(B);B=setTimeout(E,C);if(D){y=A.apply(G,F)}return y}},throttle:function(D,F){var B,A,E,y,C,z;C=0;z=function(){C=new Date();E=null;y=D.apply(B,A)};return function(){var G=new Date(),H=F-(G-C);B=this;A=arguments;if(H<=0){clearTimeout(E);E=null;C=G;y=D.apply(B,A)}else{if(!E){E=setTimeout(z,H)}}return y}},noop:function(){}}}();var p="0.10.5";var r=function(){return{nonword:w,whitespace:x,obj:{nonword:y(w),whitespace:y(x)}};function x(z){z=u.toStr(z);return z?z.split(/\s+/):[]}function w(z){z=u.toStr(z);return z?z.split(/\W+/):[]}function y(A){return function z(){var B=[].slice.call(arguments,0);return function C(E){var D=[];u.each(B,function(F){D=D.concat(A(u.toStr(E[F])))});return D}}}}();var h=function(){function x(E){this.maxSize=u.isNumber(E)?E:100;this.reset();if(this.maxSize<=0){this.set=this.get=f.noop}}u.mixin(x.prototype,{set:function D(E,H){var G=this.list.tail,F;if(this.size>=this.maxSize){this.list.remove(G);delete this.hash[G.key]}if(F=this.hash[E]){F.val=H;this.list.moveToFront(F)}else{F=new y(E,H);this.list.add(F);this.hash[E]=F;this.size++}},get:function z(E){var F=this.hash[E];if(F){this.list.moveToFront(F);return F.val}},reset:function B(){this.size=0;this.hash={};this.list=new A()}});function A(){this.head=this.tail=null}u.mixin(A.prototype,{add:function C(E){if(this.head){E.next=this.head;this.head.prev=E}this.head=E;this.tail=this.tail||E},remove:function w(E){E.prev?E.prev.next=E.next:this.head=E.next;E.next?E.next.prev=E.prev:this.tail=E.prev},moveToFront:function(E){this.remove(E);this.add(E)}});function y(E,F){this.key=E;this.val=F;this.prev=this.next=null}return x}();var s=function(){var w,x;try{w=window.localStorage;w.setItem("~~~","!");w.removeItem("~~~")}catch(B){w=null}function z(D){this.prefix=["__",D,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+u.escapeRegExChars(this.prefix))}if(w&&window.JSON){x={_prefix:function(D){return this.prefix+D},_ttlKey:function(D){return this._prefix(D)+this.ttlKey},get:function(D){if(this.isExpired(D)){this.remove(D)}return C(w.getItem(this._prefix(D)))},set:function(E,F,D){if(u.isNumber(D)){w.setItem(this._ttlKey(E),A(y()+D))}else{w.removeItem(this._ttlKey(E))}return w.setItem(this._prefix(E),A(F))},remove:function(D){w.removeItem(this._ttlKey(D));w.removeItem(this._prefix(D));return this},clear:function(){var F,E,G=[],D=w.length;for(F=0;F<D;F++){if((E=w.key(F)).match(this.keyMatcher)){G.push(E.replace(this.keyMatcher,""))}}for(F=G.length;F--;){this.remove(G[F])}return this},isExpired:function(E){var D=C(w.getItem(this._ttlKey(E)));return u.isNumber(D)&&y()>D?true:false}}}else{x={get:u.noop,set:u.noop,remove:u.noop,clear:u.noop,isExpired:u.noop}}u.mixin(z.prototype,x);return z;function y(){return new Date().getTime()}function A(D){return JSON.stringify(u.isUndefined(D)?null:D)}function C(D){return JSON.parse(D)}}();var t=function(){var y=0,A={},w=6,z=new h(10);function D(E){E=E||{};this.cancelled=false;this.lastUrl=null;this._send=E.transport?B(E.transport):f.ajax;this._get=E.rateLimiter?E.rateLimiter(this._get):this._get;this._cache=E.cache===false?new h(0):z}D.setMaxPendingRequests=function x(E){w=E};D.resetCache=function C(){z.reset()};u.mixin(D.prototype,{_get:function(I,L,F){var K=this,J;if(this.cancelled||I!==this.lastUrl){return}if(J=A[I]){J.done(H).fail(G)}else{if(y<w){y++;A[I]=this._send(I,L).done(H).fail(G).always(E)}else{this.onDeckRequestArgs=[].slice.call(arguments,0)}}function H(M){F&&F(null,M);K._cache.set(I,M)}function G(){F&&F(true)}function E(){y--;delete A[I];if(K.onDeckRequestArgs){K._get.apply(K,K.onDeckRequestArgs);K.onDeckRequestArgs=null}}},get:function(F,H,E){var G;if(u.isFunction(H)){E=H;H={}}this.cancelled=false;this.lastUrl=F;if(G=this._cache.get(F)){u.defer(function(){E&&E(null,G)})}else{this._get(F,H,E)}return !!G},cancel:function(){this.cancelled=true}});return D;function B(E){return function F(H,K){var G=f.Deferred();E(H,K,J,I);return G;function J(L){u.defer(function(){G.resolve(L)})}function I(L){u.defer(function(){G.reject(L)})}}}}();var m=function(){function w(F){F=F||{};if(!F.datumTokenizer||!F.queryTokenizer){f.error("datumTokenizer and queryTokenizer are both required")}this.datumTokenizer=F.datumTokenizer;this.queryTokenizer=F.queryTokenizer;this.reset()}u.mixin(w.prototype,{bootstrap:function y(F){this.datums=F.datums;this.trie=F.trie},add:function(G){var F=this;G=u.isArray(G)?G:[G];u.each(G,function(H){var J,I;J=F.datums.push(H)-1;I=A(F.datumTokenizer(H));u.each(I,function(K){var N,M,L;N=F.trie;M=K.split("");while(L=M.shift()){N=N.children[L]||(N.children[L]=D());N.ids.push(J)}})})},get:function x(H){var F=this,I,G;I=A(this.queryTokenizer(H));u.each(I,function(J){var N,M,L,K;if(G&&G.length===0){return false}N=F.trie;M=J.split("");while(N&&(L=M.shift())){N=N.children[L]}if(N&&M.length===0){K=N.ids.slice(0);G=G?B(G,K):K}else{G=[];return false}});return G?u.map(z(G),function(J){return F.datums[J]}):[]},reset:function C(){this.datums=[];this.trie=D()},serialize:function E(){return{datums:this.datums,trie:this.trie}}});return w;function A(F){F=u.filter(F,function(G){return !!G});F=u.map(F,function(G){return G.toLowerCase()});return F}function D(){return{ids:[],children:{}}}function z(J){var G={},I=[];for(var H=0,F=J.length;H<F;H++){if(!G[J[H]]){G[J[H]]=true;I.push(J[H])}}return I}function B(K,I){var G=0,J=0,M=[];K=K.sort(L);I=I.sort(L);var H=K.length,F=I.length;while(G<H&&J<F){if(K[G]<I[J]){G++}else{if(K[G]>I[J]){J++}else{M.push(K[G]);G++;J++}}}return M;function L(O,N){return O-N}}}();var j=function(){return{local:y,prefetch:w,remote:x};function y(z){return z.local||null}function w(B){var A,z;z={url:null,thumbprint:"",ttl:24*60*60*1000,filter:null,ajax:{}};if(A=B.prefetch||null){A=u.isString(A)?{url:A}:A;A=u.mixin(z,A);A.thumbprint=p+A.thumbprint;A.ajax.type=A.ajax.type||"GET";A.ajax.dataType=A.ajax.dataType||"json";!A.url&&f.error("prefetch requires url to be set")}return A}function x(D){var B,C;C={url:null,cache:true,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}};if(B=D.remote||null){B=u.isString(B)?{url:B}:B;B=u.mixin(C,B);B.rateLimiter=/^throttle$/i.test(B.rateLimitBy)?A(B.rateLimitWait):z(B.rateLimitWait);B.ajax.type=B.ajax.type||"GET";B.ajax.dataType=B.ajax.dataType||"json";delete B.rateLimitBy;delete B.rateLimitWait;!B.url&&f.error("remote requires url to be set")}return B;function z(E){return function(F){return u.debounce(F,E)}}function A(E){return function(F){return u.throttle(F,E)}}}}();(function(H){var w,C;w=H.Bloodhound;C={data:"data",protocol:"protocol",thumbprint:"thumbprint"};H.Bloodhound=y;function y(P){if(!P||!P.local&&!P.prefetch&&!P.remote){f.error("one of local, prefetch, or remote is required")}this.limit=P.limit||5;this.sorter=F(P.sorter);this.dupDetector=P.dupDetector||E;this.local=j.local(P);this.prefetch=j.prefetch(P);this.remote=j.remote(P);this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null;this.index=new m({datumTokenizer:P.datumTokenizer,queryTokenizer:P.queryTokenizer});this.storage=this.cacheKey?new s(this.cacheKey):null}y.noConflict=function O(){H.Bloodhound=w;return y};y.tokenizers=r;u.mixin(y.prototype,{_loadPrefetch:function z(T){var Q=this,S,P;if(S=this._readFromStorage(T.thumbprint)){this.index.bootstrap(S);P=f.Deferred().resolve()}else{P=f.ajax(T.url,T.ajax).done(R)}return P;function R(U){Q.clear();Q.add(T.filter?T.filter(U):U);Q._saveToStorage(Q.index.serialize(),T.thumbprint,T.ttl)}},_getFromRemote:function B(U,P){var T=this,R,S;if(!this.transport){return}U=U||"";S=encodeURIComponent(U);R=this.remote.replace?this.remote.replace(this.remote.url,U):this.remote.url.replace(this.remote.wildcard,S);return this.transport.get(R,this.remote.ajax,Q);function Q(V,W){V?P([]):P(T.remote.filter?T.remote.filter(W):W)}},_cancelLastRemoteRequest:function N(){this.transport&&this.transport.cancel()},_saveToStorage:function I(R,Q,P){if(this.storage){this.storage.set(C.data,R,P);this.storage.set(C.protocol,location.protocol,P);this.storage.set(C.thumbprint,Q,P)}},_readFromStorage:function M(Q){var P={},R;if(this.storage){P.data=this.storage.get(C.data);P.protocol=this.storage.get(C.protocol);P.thumbprint=this.storage.get(C.thumbprint)}R=P.thumbprint!==Q||P.protocol!==location.protocol;return P.data&&!R?P.data:null},_initialize:function x(){var S=this,R=this.local,P;P=this.prefetch?this._loadPrefetch(this.prefetch):f.Deferred().resolve();R&&P.done(Q);this.transport=this.remote?new t(this.remote):null;return this.initPromise=P.promise();function Q(){S.add(u.isFunction(R)?R():R)}},initialize:function x(P){return !this.initPromise||P?this._initialize():this.initPromise},add:function D(P){this.index.add(P)},get:function K(T,P){var R=this,S=[],Q=false;S=this.index.get(T);S=this.sorter(S).slice(0,this.limit);S.length<this.limit?Q=this._getFromRemote(T,U):this._cancelLastRemoteRequest();if(!Q){(S.length>0||!this.transport)&&P&&P(S)}function U(W){var V=S.slice(0);u.each(W,function(Y){var X;X=u.some(V,function(Z){return R.dupDetector(Y,Z)});!X&&V.push(Y);return V.length<R.limit});P&&P(R.sorter(V))}},clear:function G(){this.index.reset()},clearPrefetchCache:function A(){this.storage&&this.storage.clear()},clearRemoteCache:function J(){this.transport&&t.resetCache()},ttAdapter:function L(){return u.bind(this.get,this)}});return y;function F(Q){return u.isFunction(Q)?P:R;function P(S){return S.sort(Q)}function R(S){return S}}function E(){return false}})(this);var l=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'}}();var k=function(){var w={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};if(u.isMsie()){u.mixin(w.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"})}if(u.isMsie()&&u.isMsie()<=7){u.mixin(w.input,{marginTop:"-1px"})}return w}();var e=function(){var x="typeahead:";function w(y){if(!y||!y.el){f.error("EventBus initialized without el")}this.$el=f(y.el)}u.mixin(w.prototype,{trigger:function(z){var y=[].slice.call(arguments,1);this.$el.trigger(x+z,y)}});return w}();var i=function(){var y=/\s+/,C=w();return{onSync:D,onAsync:x,off:z,trigger:A};function E(K,I,G,H){var J;if(!G){return this}I=I.split(y);G=H?F(G,H):G;this._callbacks=this._callbacks||{};while(J=I.shift()){this._callbacks[J]=this._callbacks[J]||{sync:[],async:[]};this._callbacks[J][K].push(G)}return this}function x(I,G,H){return E.call(this,"async",I,G,H)}function D(I,G,H){return E.call(this,"sync",I,G,H)}function z(G){var H;if(!this._callbacks){return this}G=G.split(y);while(H=G.shift()){delete this._callbacks[H]}return this}function A(H){var I,J,G,K,L;if(!this._callbacks){return this}H=H.split(y);G=[].slice.call(arguments,1);while((I=H.shift())&&(J=this._callbacks[I])){K=B(J.sync,this,[I].concat(G));L=B(J.async,this,[I].concat(G));K()&&C(L)}return this}function B(J,I,H){return G;function G(){var M;for(var L=0,K=J.length;!M&&L<K;L+=1){M=J[L].apply(I,H)===false}return !M}}function w(){var H;if(window.setImmediate){H=function I(J){setImmediate(function(){J()})}}else{H=function G(J){setTimeout(function(){J()},0)}}return H}function F(H,G){return H.bind?H.bind(G):function(){H.apply(G,[].slice.call(arguments,0))}}}();var g=function(z){var y={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:false,caseSensitive:false};return function x(D){var A;D=u.mixin({},y,D);if(!D.node||!D.pattern){return}D.pattern=u.isArray(D.pattern)?D.pattern:[D.pattern];A=w(D.pattern,D.caseSensitive,D.wordsOnly);B(D.node,C);function C(H){var F,E,G;if(F=A.exec(H.data)){G=z.createElement(D.tagName);D.className&&(G.className=D.className);E=H.splitText(F.index);E.splitText(F[0].length);G.appendChild(E.cloneNode(true));H.parentNode.replaceChild(G,E)}return !!F}function B(H,I){var F,G=3;for(var E=0;E<H.childNodes.length;E++){F=H.childNodes[E];if(F.nodeType===G){E+=I(F)?1:0}else{B(F,I)}}}};function w(D,B,G){var F=[],E;for(var C=0,A=D.length;C<A;C++){F.push(u.escapeRegExChars(D[C]))}E=G?"\\b("+F.join("|")+")\\b":"("+F.join("|")+")";return B?new RegExp(E):new RegExp(E,"i")}}(window.document);var o=function(){var S;S={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};function P(ab){var Z=this,aa,W,Y,X;ab=ab||{};if(!ab.input){f.error("input is missing")}aa=u.bind(this._onBlur,this);W=u.bind(this._onFocus,this);Y=u.bind(this._onKeydown,this);X=u.bind(this._onInput,this);this.$hint=f(ab.hint);this.$input=f(ab.input).on("blur.tt",aa).on("focus.tt",W).on("keydown.tt",Y);if(this.$hint.length===0){this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=u.noop}if(!u.isMsie()){this.$input.on("input.tt",X)}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(ac){if(S[ac.which||ac.keyCode]){return}u.defer(u.bind(Z._onInput,Z,ac))})}this.query=this.$input.val();this.$overflowHelper=I(this.$input)}P.normalizeQuery=function(W){return(W||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")};u.mixin(P.prototype,i,{_onBlur:function G(){this.resetInputValue();this.trigger("blurred")},_onFocus:function A(){this.trigger("focused")},_onKeydown:function U(W){var X=S[W.which||W.keyCode];this._managePreventDefault(X,W);if(X&&this._shouldTrigger(X,W)){this.trigger(X+"Keyed",W)}},_onInput:function x(){this._checkInputValue()},_managePreventDefault:function C(aa,Z){var Y,X,W;switch(aa){case"tab":X=this.getHint();W=this.getInputValue();Y=X&&X!==W&&!J(Z);break;case"up":case"down":Y=!J(Z);break;default:Y=false}Y&&Z.preventDefault()},_shouldTrigger:function V(Y,X){var W;switch(Y){case"tab":W=!J(X);break;default:W=true}return W},_checkInputValue:function D(){var W,X,Y;W=this.getInputValue();X=F(W,this.query);Y=X?this.query.length!==W.length:false;this.query=W;if(!X){this.trigger("queryChanged",this.query)}else{if(Y){this.trigger("whitespaceChanged",this.query)}}},focus:function L(){this.$input.focus()},blur:function Q(){this.$input.blur()},getQuery:function N(){return this.query},setQuery:function M(W){this.query=W},getInputValue:function B(){return this.$input.val()},setInputValue:function E(X,W){this.$input.val(X);W?this.clearHint():this._checkInputValue()},resetInputValue:function z(){this.setInputValue(this.query,true)},getHint:function y(){return this.$hint.val()},setHint:function R(W){this.$hint.val(W)},clearHint:function H(){this.setHint("")},clearHintIfInvalid:function w(){var Z,Y,W,X;Z=this.getInputValue();Y=this.getHint();W=Z!==Y&&Y.indexOf(Z)===0;X=Z!==""&&W&&!this.hasOverflow();!X&&this.clearHint()},getLanguageDirection:function K(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function O(){var W=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=W},isCursorAtEnd:function(){var X,Y,W;X=this.$input.val().length;Y=this.$input[0].selectionStart;if(u.isNumber(Y)){return Y===X}else{if(document.selection){W=document.selection.createRange();W.moveStart("character",-X);return X===W.text.length}}return true},destroy:function T(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null}});return P;function I(W){return f('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:W.css("font-family"),fontSize:W.css("font-size"),fontStyle:W.css("font-style"),fontVariant:W.css("font-variant"),fontWeight:W.css("font-weight"),wordSpacing:W.css("word-spacing"),letterSpacing:W.css("letter-spacing"),textIndent:W.css("text-indent"),textRendering:W.css("text-rendering"),textTransform:W.css("text-transform")}).insertAfter(W)}function F(X,W){return P.normalizeQuery(X)===P.normalizeQuery(W)}function J(W){return W.altKey||W.ctrlKey||W.metaKey||W.shiftKey}}();var v=function(){var x="ttDataset",L="ttValue",F="ttDatum";function w(M){M=M||{};M.templates=M.templates||{};if(!M.source){f.error("missing source")}if(M.name&&!z(M.name)){f.error("invalid dataset name: "+M.name)}this.query=null;this.highlight=!!M.highlight;this.name=M.name||u.getUniqueId();this.source=M.source;this.displayFn=A(M.display||M.displayKey);this.templates=B(M.templates,this.displayFn);this.$el=f(l.dataset.replace("%CLASS%",this.name))}w.extractDatasetName=function J(M){return f(M).data(x)};w.extractValue=function G(M){return f(M).data(L)};w.extractDatum=function G(M){return f(M).data(F)};u.mixin(w.prototype,i,{_render:function y(S,M){if(!this.$el){return}var R=this,O;this.$el.empty();O=M&&M.length;if(!O&&this.templates.empty){this.$el.html(N()).prepend(R.templates.header?Q():null).append(R.templates.footer?P():null)}else{if(O){this.$el.html(T()).prepend(R.templates.header?Q():null).append(R.templates.footer?P():null)}}this.trigger("rendered");function N(){return R.templates.empty({query:S,isEmpty:true})}function T(){var V,U;V=f(l.suggestions).css(k.suggestions);U=u.map(M,W);V.append.apply(V,U);R.highlight&&g({className:"tt-highlight",node:V[0],pattern:S});return V;function W(X){var Y;Y=f(l.suggestion).append(R.templates.suggestion(X)).data(x,R.name).data(L,R.displayFn(X)).data(F,X);Y.children().each(function(){f(this).css(k.suggestionChild)});return Y}}function Q(){return R.templates.header({query:S,isEmpty:!O})}function P(){return R.templates.footer({query:S,isEmpty:!O})}},getRoot:function H(){return this.$el},update:function C(O){var N=this;this.query=O;this.canceled=false;this.source(O,M);function M(P){if(!N.canceled&&O===N.query){N._render(O,P)}}},cancel:function K(){this.canceled=true},clear:function E(){this.cancel();this.$el.empty();this.trigger("rendered")},isEmpty:function D(){return this.$el.is(":empty")},destroy:function I(){this.$el=null}});return w;function A(M){M=M||"value";return u.isFunction(M)?M:N;function N(O){return O[M]}}function B(N,O){return{empty:N.empty&&u.templatify(N.empty),header:N.header&&u.templatify(N.header),footer:N.footer&&u.templatify(N.footer),suggestion:N.suggestion||M};function M(P){return"<p>"+O(P)+"</p>"}}function z(M){return/^[_a-zA-Z0-9-]+$/.test(M)}}();var q=function(){function P(Y){var W=this,U,X,V;Y=Y||{};if(!Y.menu){f.error("menu is required")}this.isOpen=false;this.isEmpty=true;this.datasets=u.map(Y.datasets,G);U=u.bind(this._onSuggestionClick,this);X=u.bind(this._onSuggestionMouseEnter,this);V=u.bind(this._onSuggestionMouseLeave,this);this.$menu=f(Y.menu).on("click.tt",".tt-suggestion",U).on("mouseenter.tt",".tt-suggestion",X).on("mouseleave.tt",".tt-suggestion",V);u.each(this.datasets,function(Z){W.$menu.append(Z.getRoot());Z.onSync("rendered",W._onRendered,W)})}u.mixin(P.prototype,i,{_onSuggestionClick:function O(U){this.trigger("suggestionClicked",f(U.currentTarget))},_onSuggestionMouseEnter:function w(U){this._removeCursor();this._setCursor(f(U.currentTarget),true)},_onSuggestionMouseLeave:function J(){this._removeCursor()},_onRendered:function C(){this.isEmpty=u.every(this.datasets,U);this.isEmpty?this._hide():this.isOpen&&this._show();this.trigger("datasetRendered");function U(V){return V.isEmpty()}},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function B(){return this.$menu.find(".tt-suggestion")},_getCursor:function z(){return this.$menu.find(".tt-cursor").first()},_setCursor:function R(V,U){V.first().addClass("tt-cursor");!U&&this.trigger("cursorMoved")},_removeCursor:function y(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function x(U){var W,V,Y,X;if(!this.isOpen){return}V=this._getCursor();W=this._getSuggestions();this._removeCursor();Y=W.index(V)+U;Y=(Y+1)%(W.length+1)-1;if(Y===-1){this.trigger("cursorRemoved");return}else{if(Y<-1){Y=W.length-1}}this._setCursor(X=W.eq(Y));this._ensureVisible(X)},_ensureVisible:function N(X){var U,W,V,Y;U=X.position().top;W=U+X.outerHeight(true);V=this.$menu.scrollTop();Y=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10);if(U<0){this.$menu.scrollTop(V+U)}else{if(Y<W){this.$menu.scrollTop(V+(W-Y))}}},close:function K(){if(this.isOpen){this.isOpen=false;this._removeCursor();this._hide();this.trigger("closed")}},open:function I(){if(!this.isOpen){this.isOpen=true;!this.isEmpty&&this._show();this.trigger("opened")}},setLanguageDirection:function S(U){this.$menu.css(U==="ltr"?k.ltr:k.rtl)},moveCursorUp:function D(){this._moveCursor(-1)},moveCursorDown:function T(){this._moveCursor(+1)},getDatumForSuggestion:function F(V){var U=null;if(V.length){U={raw:v.extractDatum(V),value:v.extractValue(V),datasetName:v.extractDatasetName(V)}}return U},getDatumForCursor:function A(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function M(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function E(U){u.each(this.datasets,V);function V(W){W.update(U)}},empty:function H(){u.each(this.datasets,U);this.isEmpty=true;function U(V){V.clear()}},isVisible:function L(){return this.isOpen&&!this.isEmpty},destroy:function Q(){this.$menu.off(".tt");this.$menu=null;u.each(this.datasets,U);function U(V){V.destroy()}}});return P;function G(U){return new v(U)}}();var n=function(){var X="ttAttrs";function H(ad){var ac,ae,ab;ad=ad||{};if(!ad.input){f.error("missing input")}this.isActivated=false;this.autoselect=!!ad.autoselect;this.minLength=u.isNumber(ad.minLength)?ad.minLength:1;this.$node=R(ad.input,ad.withHint);ac=this.$node.find(".tt-dropdown-menu");ae=this.$node.find(".tt-input");ab=this.$node.find(".tt-hint");ae.on("blur.tt",function(ag){var ai,ah,af;ai=document.activeElement;ah=ac.is(ai);af=ac.has(ai).length>0;if(u.isMsie()&&(ah||af)){ag.preventDefault();ag.stopImmediatePropagation();u.defer(function(){ae.focus()})}});ac.on("mousedown.tt",function(af){af.preventDefault()});this.eventBus=ad.eventBus||new e({el:ae});this.dropdown=new q({menu:ac,datasets:ad.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this);this.input=new o({input:ae,hint:ab}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this);this._setLanguageDirection()}u.mixin(H.prototype,{_onSuggestionClicked:function y(ad,ac){var ab;if(ab=this.dropdown.getDatumForSuggestion(ac)){this._select(ab)}},_onCursorMoved:function S(){var ab=this.dropdown.getDatumForCursor();this.input.setInputValue(ab.value,true);this.eventBus.trigger("cursorchanged",ab.raw,ab.datasetName)},_onCursorRemoved:function B(){this.input.resetInputValue();this._updateHint()},_onDatasetRendered:function N(){this._updateHint()},_onOpened:function z(){this._updateHint();this.eventBus.trigger("opened")},_onClosed:function E(){this.input.clearHint();this.eventBus.trigger("closed")},_onFocused:function P(){this.isActivated=true;this.dropdown.open()},_onBlurred:function Q(){this.isActivated=false;this.dropdown.empty();this.dropdown.close()},_onEnterKeyed:function L(ac,ab){var ad,ae;ad=this.dropdown.getDatumForCursor();ae=this.dropdown.getDatumForTopSuggestion();if(ad){this._select(ad);ab.preventDefault()}else{if(this.autoselect&&ae){this._select(ae);ab.preventDefault()}}},_onTabKeyed:function aa(ad,ac){var ab;if(ab=this.dropdown.getDatumForCursor()){this._select(ab);ac.preventDefault()}else{this._autocomplete(true)}},_onEscKeyed:function V(){this.dropdown.close();this.input.resetInputValue()},_onUpKeyed:function x(){var ab=this.input.getQuery();this.dropdown.isEmpty&&ab.length>=this.minLength?this.dropdown.update(ab):this.dropdown.moveCursorUp();this.dropdown.open()},_onDownKeyed:function C(){var ab=this.input.getQuery();this.dropdown.isEmpty&&ab.length>=this.minLength?this.dropdown.update(ab):this.dropdown.moveCursorDown();this.dropdown.open()},_onLeftKeyed:function Z(){this.dir==="rtl"&&this._autocomplete()},_onRightKeyed:function M(){this.dir==="ltr"&&this._autocomplete()},_onQueryChanged:function J(ac,ab){this.input.clearHintIfInvalid();ab.length>=this.minLength?this.dropdown.update(ab):this.dropdown.empty();this.dropdown.open();this._setLanguageDirection()},_onWhitespaceChanged:function W(){this._updateHint();this.dropdown.open()},_setLanguageDirection:function U(){var ab;if(this.dir!==(ab=this.input.getLanguageDirection())){this.dir=ab;this.$node.css("direction",ab);this.dropdown.setLanguageDirection(ab)}},_updateHint:function O(){var ac,ag,af,ae,ab,ad;ac=this.dropdown.getDatumForTopSuggestion();if(ac&&this.dropdown.isVisible()&&!this.input.hasOverflow()){ag=this.input.getInputValue();af=o.normalizeQuery(ag);ae=u.escapeRegExChars(af);ab=new RegExp("^(?:"+ae+")(.+$)","i");ad=ab.exec(ac.value);ad?this.input.setHint(ag+ad[1]):this.input.clearHint()}else{this.input.clearHint()}},_autocomplete:function Y(ad){var af,ae,ab,ac;af=this.input.getHint();ae=this.input.getQuery();ab=ad||this.input.isCursorAtEnd();if(af&&ae!==af&&ab){ac=this.dropdown.getDatumForTopSuggestion();ac&&this.input.setInputValue(ac.value);this.eventBus.trigger("autocompleted",ac.raw,ac.datasetName)}},_select:function K(ab){this.input.setQuery(ab.value);this.input.setInputValue(ab.value,true);this._setLanguageDirection();this.eventBus.trigger("selected",ab.raw,ab.datasetName);this.dropdown.close();u.defer(u.bind(this.dropdown.empty,this.dropdown))},open:function G(){this.dropdown.open()},close:function I(){this.dropdown.close()},setVal:function w(ab){ab=u.toStr(ab);if(this.isActivated){this.input.setInputValue(ab)}else{this.input.setQuery(ab);this.input.setInputValue(ab,true)}this._setLanguageDirection()},getVal:function F(){return this.input.getQuery()},destroy:function T(){this.input.destroy();this.dropdown.destroy();A(this.$node);this.$node=null}});return H;function R(ab,ag){var ah,ad,af,ac;ah=f(ab);ad=f(l.wrapper).css(k.wrapper);af=f(l.dropdown).css(k.dropdown);ac=ah.clone().css(k.hint).css(D(ah));ac.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",true).attr({autocomplete:"off",spellcheck:"false",tabindex:-1});ah.data(X,{dir:ah.attr("dir"),autocomplete:ah.attr("autocomplete"),spellcheck:ah.attr("spellcheck"),style:ah.attr("style")});ah.addClass("tt-input").attr({autocomplete:"off",spellcheck:false}).css(ag?k.input:k.inputWithNoHint);try{!ah.attr("dir")&&ah.attr("dir","auto")}catch(ae){}return ah.wrap(ad).parent().prepend(ag?ac:null).append(af)}function D(ab){return{backgroundAttachment:ab.css("background-attachment"),backgroundClip:ab.css("background-clip"),backgroundColor:ab.css("background-color"),backgroundImage:ab.css("background-image"),backgroundOrigin:ab.css("background-origin"),backgroundPosition:ab.css("background-position"),backgroundRepeat:ab.css("background-repeat"),backgroundSize:ab.css("background-size")}}function A(ab){var ac=ab.find(".tt-input");u.each(ac.data(X),function(ae,ad){u.isUndefined(ae)?ac.removeAttr(ad):ac.attr(ad,ae)});ac.detach().removeData(X).removeClass("tt-input").insertAfter(ab);ab.remove()}}();(function(){var y,w,z;y=f.fn.typeahead;w="ttTypeahead";z={initialize:function A(H,G){G=u.isArray(G)?G:[].slice.call(arguments,1);H=H||{};return this.each(F);function F(){var K=f(this),I,J;u.each(G,function(L){L.highlight=!!H.highlight});J=new n({input:K,eventBus:I=new e({el:K}),withHint:u.isUndefined(H.hint)?true:!!H.hint,minLength:H.minLength,autoselect:H.autoselect,datasets:G});K.data(w,J)}},open:function B(){return this.each(F);function F(){var H=f(this),G;if(G=H.data(w)){G.open()}}},close:function E(){return this.each(F);function F(){var H=f(this),G;if(G=H.data(w)){G.close()}}},val:function x(F){return !arguments.length?H(this.first()):this.each(G);function G(){var J=f(this),I;if(I=J.data(w)){I.setVal(F)}}function H(K){var J,I;if(J=K.data(w)){I=J.getVal()}return I}},destroy:function D(){return this.each(F);function F(){var H=f(this),G;if(G=H.data(w)){G.destroy();H.removeData(w)}}}};f.fn.typeahead=function(G){var F;if(z[G]&&G!=="initialize"){F=this.filter(function(){return !!f(this).data(w)});return z[G].apply(F,[].slice.call(arguments,1))}else{return z.initialize.apply(this,arguments)}};f.fn.typeahead.noConflict=function C(){f.fn.typeahead=y;return this}})()})(window.jQuery)});
;

;
