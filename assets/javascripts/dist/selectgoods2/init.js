/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/selectgoods2/init",["$","dist/application/app","./monkey","./jq_pagination","./template/item.html","./template/item2.html"],function(a,b){"use strict";{var c=a("$"),d=a("dist/application/app"),e=a("./monkey"),f=d.config;d.method}a("./jq_pagination");var g=a("./template/item.html"),h=a("./template/item2.html");b.init=function(a){var b=function(a){this.opts=c.extend(!0,{modal:null,type:null,select:null,goodsurl:"/Plus/selectgoods.php"},a||{}),this.init()};b.prototype={init:function(){var a=this;a.create({}),a._click(),a.searchF()},create:function(a){var b=this;e.post(b.opts.goodsurl,function(a){if(f.issucceed(a)){b.opts.type==window.goods_set.type&&(a.data.selectid=b.opts.select.val()),c("#all-list-box").html(template.compile(g)(a.data));var d=function(){c("#Pagination").pagination(a.data.chief,{num_edge_entries:1,num_display_entries:4,callback:e,items_per_page:1,prev_text:"&laquo",next_text:"&raquo",load_first_page:!0})},e=function(d){if(c("#all-list-box div.list-box").hide(),!c("#all-list-box div.list-box:eq("+d+")").data("crate")){var e={};e.datas=a.data.data[d],b.opts.type==window.goods_set.type&&(e.selectid=b.opts.select.val());var f=template.compile(h)(e);c("#all-list-box div.list-box:eq("+d+")").find("ul").append(f),c("#all-list-box div.list-box:eq("+d+")").data("crate",!0)}return c("#all-list-box div.list-box:eq("+d+")").show(),!1};d()}else f.msg.error(a.message)},"",null,a)},_click:function(){},searchF:function(){var a=this;c(document).on("click","#goodssearch",function(){var b=c("form.search-form",a.opts.modal).serialize();a.create(b)})}};var d=c("[data-toggle='selectGoods']",a);d.length>0&&d.each(function(){var a=c(this);a.on("click",function(){c("li.itmes").unbind("click"),c("button.js_save_btn").unbind("click");var a=c(this),d=c(c(a.data("tmodal")).length>0?a.data("tmodal"):"#js_goodes_modal"),e=a.data("type"),f=c(c(a.data("selectid")).length>0?a.data("selectid"):"#js_selected_id"),g=a.data("target"),h=a.data("path"),i=c("#js_tr_id"),j=a.data("id");d.attr("data-type",e),d.attr("data-target",g),d.attr("data-select",a.data("selectid")||"#js_selected_id"),d.attr("data-logo",a.data("logo"));var k=c("#js_selected_id",d);i.length>0&&i.val(j),k.val(c(".js_goods_id",g).val()||a.data("goodsid")),""==k.val()&&k.val(window.goods_set.selectid),d.modal("show"),h&&new b({modal:d,type:e,button:a,select:f,goodsurl:h}),c(d,document).on("click","li.itmes",function(){var a=c(this).data("cid"),b=c(d.attr("data-select"));c("li.itmes",d).removeClass("active"),c("li.itmes",d).find("a").removeClass("active");var e=c(".goods_items_"+a);e.find("a").toggleClass("active"),e.toggleClass("active"),b.val(a)}),c(d,document).on("click","button.js_save_btn",function(){d.modal("hide");var a=c(d.attr("data-select")),b=d.attr("data-target"),e=a.val(),f=c(".goods_items_"+e),g=f.data("url"),h=f.data("imgsrc"),i=(f.data("logo"),f.data("text")),j=c(d.attr("data-logo")),k=d.attr("data-type");c(b).find("input[type='hidden']").val(e),"url"==k?c(b).find("input[type='text']").val(g):"goods"==k&&(c(b).removeClass("hide"),c(b).find("img").attr("src",h),c(b).find("p").html(i)),h&&(j.find(".prev-logo").attr("src",h).removeClass("hide"),j.find(".addlogo[data-toggle='selectimg']").addClass("hide"),j.find("button.cancleLogo").removeClass("hide"))})});var d=a.prev("input[type='text']");d.length>0&&d.on("click",function(){a.trigger("click")})})}}),define("dist/selectgoods2/monkey",["$"],function(a){"use strict";var b=a("$"),c=function(a,c,d,e,f){var g='<img src="/assets/images/loading.gif"/>',h="",i=[],j=(new Date).getTime()+parseInt(1e5*Math.random());if(j&&(h="background:rgba(255, 255, 255, 0.6); filter:alpha(opacity=30); _background:#fff;"),d.length){var k='<div style="'+h+'" id="loadingBox_'+j+'" class="monkey-ajax-loading">'+g+"</div>";b("body").append(k),i[j]=b("#loadingBox_"+j);var l=b(d),m=l.outerWidth(),n=l.outerHeight(),o=l.offset().top,p=l.offset().left,q=b("#loadingBox_"+j),r=32;q.css({position:"absolute","z-index":"10000","text-align":"center",width:m+"px",height:n-(n/2-r/2)+"px",paddingTop:n/2-r/2+"px",top:o+"px",left:p+"px"})}b.ajax(a,{type:e||"post",data:f,dataType:"json"}).done(function(a){b(d).length&&i[j]&&i[j].remove(),c&&c(a)}).fail(function(){b(d).length&&i[j]&&i[j].remove()})};return{get:function(a,b,d){c(a,b,d,"get")},post:function(a,b,d,e,f){c(a,b,d,e,f)},postd:function(a,b,d){c(a,b,!1,!1,d)},placeholder:function(a){b(a).placeholder()}}}),define("dist/selectgoods2/jq_pagination",[],function(){jQuery.fn.pagination=function(a,b){return b=jQuery.extend({items_per_page:10,num_display_entries:10,current_page:0,num_edge_entries:0,link_to:"#",prev_text:"Prev",next_text:"Next",ellipse_text:"...",prev_show_always:!0,next_show_always:!0,callback:function(){return!1}},b||{}),this.each(function(){function c(){return Math.ceil(a/b.items_per_page)}function d(){var a=Math.ceil(b.num_display_entries/2),d=c(),e=d-b.num_display_entries,f=g>a?Math.max(Math.min(g-a,e),0):0,h=g>a?Math.min(g+a,d):Math.min(b.num_display_entries,d);return[f,h]}function e(a,c){g=a,f();var d=b.callback(a,h);return d||(c.stopPropagation?c.stopPropagation():c.cancelBubble=!0),d}function f(){h.empty();var a=d(),f=c(),i=function(a){return function(b){return e(a,b)}},j=function(a,c){if(a=0>a?0:f>a?a:f-1,c=jQuery.extend({text:a+1,classes:""},c||{}),a==g)var d=jQuery("<span class='current'>"+c.text+"</span>");else var d=jQuery("<a>"+c.text+"</a>").bind("click",i(a)).attr("href",b.link_to.replace(/__id__/,a));c.classes&&d.addClass(c.classes),h.append(d)};if(b.prev_text&&(g>0||b.prev_show_always)&&j(g-1,{text:b.prev_text,classes:"prev"}),a[0]>0&&b.num_edge_entries>0){for(var k=Math.min(b.num_edge_entries,a[0]),l=0;k>l;l++)j(l);b.num_edge_entries<a[0]&&b.ellipse_text&&jQuery("<span>"+b.ellipse_text+"</span>").appendTo(h)}for(var l=a[0];l<a[1];l++)j(l);if(a[1]<f&&b.num_edge_entries>0){f-b.num_edge_entries>a[1]&&b.ellipse_text&&jQuery("<span>"+b.ellipse_text+"</span>").appendTo(h);for(var m=Math.max(f-b.num_edge_entries,a[1]),l=m;f>l;l++)j(l)}b.next_text&&(f-1>g||b.next_show_always)&&j(g+1,{text:b.next_text,classes:"next"})}var g=b.current_page;a=!a||0>a?1:a,b.items_per_page=!b.items_per_page||b.items_per_page<0?1:b.items_per_page;var h=jQuery(this);this.selectPage=function(a){e(a)},this.prevPage=function(){return g>0?(e(g-1),!0):!1},this.nextPage=function(){return g<c()-1?(e(g+1),!0):!1},f(),b.callback(g,this)})}}),define("dist/selectgoods2/template/item.html",[],' {{each data as value i}}\n  {{if i == 0}}\n    <div class="list-box" data-crate=true>\n        <ul>\n            {{each data[i] as value k}}\n                <li class="itmes {{if data[i][k].cid==selectid}}active{{/if}} goods_items_{{data[i][k].cid}}" id="" data-cid="{{data[i][k].cid}}" data-url="{{data[i][k].url}}" data-imgsrc="{{data[i][k].imgsrc}}" data-logo="{{data[i][k].logo}}" data-text="{{data[i][k].text}}">\n                    <div class="col-sm-7">\n                        <img class="thumb_img js_view_img" src="{{data[i][k].imgsrc}}" style="max-height: 60px;">{{data[i][k].text}}\n                    </div>\n                    <div  class="col-sm-3"><span class="pirce money">{{data[i][k].price}}</span></div>\n                    <div  class="col-sm-2">\n                        <a href="#" title="选择" class="{{if data[i][k].cid==selectid}}active{{/if}}"><i class="fa fa-check text-success text-active"></i><i class="fa fa-times text-danger text"></i></a>\n                    </div>\n                </li>\n            {{/each}}\n        </ul>\n    </div>\n  {{else}}\n    <div class="list-box" data-crate=false>\n      <ul>\n      </ul>\n    </div>\n  {{/if}}\n{{/each}}'),define("dist/selectgoods2/template/item2.html",[],'{{each datas as value i}}\n    <li class="itmes {{if selectid==datas[i].cid}}active{{/if}} goods_items_{{datas[i].cid}}" id="" data-cid="{{datas[i].cid}}" data-url="{{datas[i].url}}" data-imgsrc="{{datas[i].imgsrc}}" data-logo="{{datas[i].logo}}" data-text="{{datas[i].text}}">\n        <div class="col-sm-7">\n            <img class="thumb_img js_view_img" src="{{datas[i].imgsrc}}" style="max-height: 60px;">{{datas[i].text}}\n        </div>\n        <div  class="col-sm-3"><span class="pirce money">{{datas[i].price}}</span></div>\n        <div  class="col-sm-2">\n            <a href="#" title="选择" class="{{if selectid==datas[i].cid}}active{{/if}}"><i class="fa fa-check text-success text-active"></i><i class="fa fa-times text-danger text"></i></a>\n        </div>\n    </li>\n{{/each}}');